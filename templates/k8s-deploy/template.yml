spec:
  inputs:
    kube_context:
      description: "Kubernetes Agent context (e.g. org/project/kubernetes/agents:cluster)"
    namespace:
      description: "Target Kubernetes namespace"
    manifests_dir:
      default: "k8s/"
    stage:
      default: "deploy"
---
"component-job":
  tags:
    - docker
    - linux
    - amd64
  image: bitnami/kubectl:1.29
  stage: $[[ inputs.stage ]]
  variables:
    KUBE_CONTEXT: "$[[ inputs.kube_context ]]"
  script:
    - kubectl config use-context "${KUBE_CONTEXT}"
    - kubectl apply -f $[[ inputs.manifests_dir ]] -n $[[ inputs.namespace ]]
